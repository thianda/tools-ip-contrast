## 模板字段对比

```
省内资管      IP地址.2018-10-23.11.22.xlsx
集团      IP地址普通格式导出模板-IP地址-2018-11-12.xls
工信部    fpxxList20181023.xls
```

各模板字段对应表


| 序号 | 省内资管              | 集团                  | 工信部         |
| ---- | --------------------- | --------------------- | -------------- |
| 1    | IP地址                | 网段名称              | 起始IP;终止IP  |
| 2    | 联系人姓名(客户侧)    | 联系人姓名(客户侧)    | 联系人姓名     |
| 3    | 联系电话(客户侧)      | 联系人电话(客户侧)    | 联系人电话     |
| 4    | 分配使用时间          | 分配使用时间          | 分配日期       |
| 5    | 单位详细地址          | 单位详细地址          | 单位详细地址   |
| 6    | 联系人邮箱(客户侧)    | 联系人邮箱(客户侧)    | 联系人电子邮件 |
| 7    | 单位名称/具体业务信息 | 单位名称/具体业务信息 | 使用单位名称   |

```
IP 字段：
省内资管，包含掩码
集团，每个 IP 一行
工信部，起始 IP，终止 IP 分为两列
```

根据导出模板文件生成中间文件，中间文件中只保留需要对比的字段，并补充修改 IP 字段为`起始 IP`、`结束 IP` 两个字段（INT 类型）。

然后，基于 IP 地址，对比 3 个系统导出数据的以上 7个字段。若与资管系统不一致，则列出 IP 地址及不一致的字段名称。

## 一致性检查工具流程图

```mermaid
graph TD
A0(初始化)---A1[配置文件是否存在]
A1---|是|B[读取配置]
A1---|否|A2[写入默认配置]
B---C[资管导出文件是否存在]
A2---C
C---|是|D[集团导出文件是否存在]
C---|否|E[工信部导出文件是否存在]
D---|是|R1[对比资管与集团,记录结果]
E---|是|R2[对比资管与工信部,记录结果]
E---|否|Z1[给出提示,运行结束]
D---|否|Z1
R1---E
R2---R3[输出对比结果]
```

其他使用方法，查看配置文件`config.ini`即可

```ini
# Author: Xianda

# 本配置为一致性检查工具的配置
# 如需恢复默认请删除本文件，重新生成的配置即为默认配置
# 如需修改配置，修改本文件后直接保存即可

######

# 若 IP 地址分为起始、终止的，filed1 字段中用“;”(英文分号)隔开
# 程序会依次对 filed 字段进行对比并输出对比结果
# filed 字段有变化可直接在此增删改，满足一一对应即可



[省内资管]
filed1 = IP地址
filed2 = 联系人姓名(客户侧)
filed3 = 联系电话(客户侧)
filed4 = 分配使用时间
filed5 = 单位详细地址
filed6 = 联系人邮箱(客户侧)
filed7 = 单位名称/具体业务信息

[集团]
filed1 = 网段名称
filed2 = 联系人姓名(客户侧)
filed3 = 联系电话(客户侧)
filed4 = 分配使用时间
filed5 = 单位详细地址
filed6 = 联系人邮箱(客户侧)
filed7 = 单位名称/具体业务信息

[工信部备案]
filed1 = 起始IP;终止IP
filed2 = 联系人姓名
filed3 = 联系电话
filed4 = 分配使用时间
filed5 = 单位详细地址
filed6 = 联系人电子邮箱
filed7 = 单位名称
```

