## 模板字段对比

```
省内资管    IP地址.2018-10-23.11.22.xlsx
集团       IP地址普通格式导出模板-IP地址-2018-11-12.xls
工信部     fpxxList20181023.xls
```

各模板字段对应表


| 序号 | 省内资管              | 集团                  | 工信部         |
| ---- | --------------------- | --------------------- | -------------- |
| 1    | IP地址                | 网段名称              | 起始IP;终止IP  |
| 2    | 联系人姓名(客户侧)    | 联系人姓名(客户侧)    | 联系人姓名     |
| 3    | 联系电话(客户侧)      | 联系人电话(客户侧)    | 联系人电话     |
| 4    | 分配使用时间          | 分配使用时间          | 分配日期       |
| 5    | 单位详细地址          | 单位详细地址          | 单位详细地址   |
| 6    | 联系人邮箱(客户侧)    | 联系人邮箱(客户侧)    | 联系人电子邮件 |
| 7    | 单位名称/具体业务信息 | 单位名称/具体业务信息 | 使用单位名称   |

```
IP 字段：
省内资管，包含掩码
集团，每个 IP 一行
工信部，起始 IP，终止 IP 分为两列
```

根据导出模板文件生成中间文件，中间文件中只保留需要对比的字段，并补充修改 IP 字段为`起始 IP`、`结束 IP` 两个字段（INT 类型）。生成过程中过滤无用的数据。

## 过滤数据

| 数据表     | 列           | 关键字 |
| ---------- | ------------ | ------ |
| 集团       | 单位详细地址 | (空)   |
| 工信部备案 | 使用单位名称 | (空)   |

基于对应表格的对应列，过滤空值数据。在生成文件中插入 excel 公式。

打开生成文件，即可查看一致性检查结果。

## 一致性检查工具流程图

```mermaid
graph TD
A0(初始化)---A1[配置文件是否存在]
A1---|是|B[读取配置]
A1---|否|A2[写入默认配置]
B---C[资管导出文件是否存在]
A2---C
C---|是|D[集团导出文件是否存在]
C---|否|E[工信部导出文件是否存在]
D---|是|R1[对比资管与集团,记录结果]
E---|是|R2[对比资管与工信部,记录结果]
E---|否|Z1[给出提示,运行结束]
D---|否|Z1
R1---E
R2---R3[输出对比结果]
```

导出模板如有微小变化，查看并修改配置文件`config.ini`即可

```ini
# Author: Xianda

# 本配置为一致性检查工具的配置
# 如删除本配置文件，重新生成的配置文件即为默认配置
# 如需修改配置，修改本文件后直接保存即可

######

# before 表示数据的起始行（列名占用的行数）
# 若 IP 地址字段分为起始IP、终止IP的，`ip` 字段中用“;”(英文分号)隔开
# 程序会依次对 field 字段进行对比并输出对比结果
# field 字段有变化可直接在此增删改，满足一一对应即可



[对比文件名]
省内资管 = IP地址.
集团 = -IP地址-
工信部备案 = fpxxList

[省内资管]
before = 1
ip = IP地址
field2 = 联系人姓名(客户侧)
field3 = 联系电话(客户侧)
field4 = 分配使用时间
field5 = 单位详细地址
field6 = 联系人邮箱(客户侧)
field7 = 单位名称/具体业务信息

[集团]
before = 3
ip = 网段名称
field2 = 联系人姓名(客户侧)
field3 = 联系人电话(客户侧)
field4 = 分配使用时间
field5 = 单位详细地址
field6 = 联系人邮箱(客户侧)
field7 = 单位名称/具体业务信息

[工信部备案]
before = 1
ip = 起始IP;终止IP
field2 = 联系人姓名
field3 = 联系人电话
field4 = 分配日期
field5 = 单位详细地址
field6 = 联系人电子邮件
field7 = 使用单位名称
```



```python
pyinstaller -F ip-contrast.py -i favicon/favicon.ico -n [version]
```

